# 状態遷移ルール表

|操作|遷移|事前条件(状態)|事前条件(親子)|必須入力|失敗時エラー|
|---|---|---|---|---|---|
|suspend|NORMAL→SUSPENDED|NORMALであること|親がDONEなら子操作不可(409 INVALID_STATE)<br>親がSUSPENDEDなら子操作不可(409 INVALID_STATE)|progressNote(null/トリム後空NG)|400 VALIDATION_ERROR(progressNoteの不正)<br>404 NOT_FOUND<br>409 INVALID_STATE(状態不一致、DONEで操作、親がSUSPENDED/DONEで子操作不可)|
|resume|SUSPENDED→NORMAL|SUSPENDEDであること|親がDONEなら子操作不可(409 INVALID_STATE)<br>親がSUSPENDEDなら子操作不可(409 INVALID_STATE)|なし|404 NOT_FOUND<br>409 INVALID_STATE(状態不一致)|
|send-to-waiting|NORMAL→WAITING_REVIEW|NORMALであること|親がDONEなら子操作不可(409 INVALID_STATE)<br>親がSUSPENDEDなら子操作不可(409 INVALID_STATE)|waitingReason(null/トリム後空NG)|400 VALIDATION_ERROR(waitingReasonの不正)<br>404 NOT_FOUND<br>409 INVALID_STATE(状態不一致)|
|approve|WAITING_REVIEW→DONE|WAITING_REVIEWであること|親がDONEなら子操作不可(409 INVALID_STATE)<br>親がSUSPENDEDなら子操作不可(409 INVALID_STATE)|なし|404 NOT_FOUND<br>409：<br>&emsp;INVALID_STATE<br>&emsp;CHILDREN_INCOMPLETE(未完了の子タスクあり)|
|reject|WAITING_REVIEW→NORMAL|WAITING_REVIEWであること|親がDONEなら子操作不可(409 INVALID_STATE)<br>親がSUSPENDEDなら子操作不可(409 INVALID_STATE)|なし|404 NOT_FOUND<br>409 INVALID_STATE|
|complete|NORMAL→DONE|NORMALであること|親がDONEなら子操作不可(409 INVALID_STATE)<br>親がSUSPENDEDなら子操作不可(409 INVALID_STATE)|なし|404 NOT_FOUND<br>409：<br>&emsp;INVALID_STATE<br>&emsp;CHILDREN_INCOMPLETE|

### 注記
- DONEでは全操作NG(409 INVALID_STATE)
- 親がDONEまたはSUSPENDEDの場合、子は操作不可(409 INVALID_STATE)
- 子タスクの「完了扱い」はDONEのみ(WAITING_REVIEWは完了扱いにしない)